/*
* Wrape v1.0.4
* Author: Elis <contact@elis.cc>
* License: MIT
*/
function Wrape(e,t){e=e||{};function r(){return t.constructed?function(e){return this.def_values=e,this}:{new:function(e){var t=Object.assign({},this);return delete t.new,t._def_values=e,t}}}function a(e){return null==e}function n(e){e.method="string"==typeof e.method?e.method.toUpperCase():"GET";var r=["headers","body","query","path"],n=["multipart/form-data","application/x-www-form-urlencoded"];e.enctype=e.enctype&&n.includes(e.enctype)?e.enctype:n[0];var s={POST:"body",GET:"query"};return async function(o){var i=`${t.base}${e.path}`,u={method:e.method,headers:t.headers,agent:t.agent};request_params=Object.keys(e.params),argument_params=Array.from(arguments),o=argument_params.length>1?argument_params.reduce(function(e,t,r){return request_params[r]?(e[request_params[r]]=t,e):e},{}):1==argument_params.length&&1==request_params.length&&"object"!=typeof argument_params[0]?{[request_params[0]]:argument_params[0]}:o||{},this.def_values=this.def_values||{};var f,p=e.enctype==n[0]?new FormData:new URLSearchParams,d=new URLSearchParams;for(var c in e.params){var h=e.params[c],l=o[c]||this.def_values[c]||t.params[c]||h.default,m=h.name||c;if(h.required&&a(l))throw new Error(h.help||`The '${c}' field is required.`);if(!a(l)){if("function"==typeof h.format&&(l=h.format(l)),h.validate&&!new RegExp(h.validate).test(l))throw new Error(h.help||`The '${c}' field is invalid.`);var y="string"==typeof h.location?h.location.toLowerCase():s[u.method];if(!y||!r.includes(y))throw new Error(`Invalid location for '${c}' field.`);"headers"!=y?"body"!=y?"query"!=y?"path"==y&&(i=i.replace(new RegExp(`:${f=c,f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}`),l)):d.append(m,l):p.append(m,l):(u.headers=u.headers||{},u.headers[m]=l)}}return(d=d.toString())&&(i=`${i}?${d}`),function(e){for(var t of e)return!1;return!0}(p.keys())||(u.body=e.enctype==n[0]?p:p.toString()),function(e,t,r){return fetch(e,t).then(async function(e){if(!e.ok)return Promise.reject(e);var t=e.headers.get("Content-Type"),r={status_code:e.status,status:e.status,statusText:e.statusText,headers:e.headers};return t&&new RegExp("application/json").test(t)?r.json=await e.json():t&&new RegExp("text/").test(t)?r.text=await e.text():r.arrayBuffer=await e.arrayBuffer(),r})}(i,u)}}return t=Object.assign({base:"",headers:{},params:{},agent:!1,constructed:!0},t),function e(a,s,o=!1){for(var i in s){var u=s[i];if(u.hasOwnProperty("path")){var f=u;if(a._ne=!0,void 0!==a[i]){console.warn(`Skipping ${i} as it confilicts with another key in the object, avoid using keys like ('name','length','caller','apply',...) because they are reserved constructor words.`),t.constructed&&(a.prototype[i]=n(f));continue}a[i]=n(f),t.constructed&&(a.prototype[i]=a[i])}else a[i]=e(r(),u)}return a._ne||o?a:{}}(r(),e,!0)}!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.Wrape=t()}("undefined"!=typeof self?self:this,function(){return Wrape});