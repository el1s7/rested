/*!
 * Wrape v1.2.61
 * Author: Elis <contact@elis.cc>
 * License: MIT
 */
function Wrape(e,t,n,r){n=n||{};r=Object.assign({base:"",headers:{},values:{},sender:!1,request_middleware:null,response_middleware:null,fetch_parse:!0,fetch_agent:!1,fetch_error_handler:!1},r);const a={form:"multipart/form-data",url:"application/x-www-form-urlencoded",json:"application/json",text:"text/plain"},o=Object.values(a),i=["headers","body","query","path"],s={POST:"body",GET:"query"},u={"multipart/form-data":function(){var e=new t;return e.toString=function(){return this},e},"application/x-www-form-urlencoded":function(){return new URLSearchParams},"application/json":function(){return{append:function(e,t){this.data=this.data||{},this.data[e]=t},toString:function(){return JSON.stringify(this.data)},isEmpty:function(){return!this.data||0==Object.keys(this.data).length}}},"text/plain":function(){return{append:function(e,t){return this.data=this.data||[],this.data.push(t)},toString:function(){return this.data.join("")},isEmpty:function(){return!this.data||0==this.data.length}}}};function f(e){return null==e}function c(e){for(var t of e)return!1;return!0}function d(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function l(t,n,r,a){return"function"==typeof r.sender?r.sender(t,n,a,r):e(t,n).then((async function(e){var o={},i=r.fetch_parse,s="function"==typeof a?a:null,u="function"==typeof r.fetch_error_handler?r.fetch_error_handler:null;try{if(i){var f=e.headers.get("Content-Type");o={status_code:e.status,status:e.status,statusText:e.statusText,headers:e.headers},f&&new RegExp("application/json").test(f)?o.json=await e.json():o.text=await e.text();var c=e.ok?"Success.":"Something went wrong.";o.message=o.json&&o.json.message?o.json.message:c}else o=e;if(!e.ok)throw new Error("Request failed.")}catch(e){return u?u(e,{url:t,options:n},o):Promise.reject(e)}return s?s(o):o}))}function p(e,t,n){var a={[t=t||"Wrape"]:function(o){if(!(this instanceof a[t]))throw new Error("You must initalize this object using 'new' command.");Object.assign(this,e);const i=function(e){if(this instanceof i)throw new Error("This object is already initialized.");this.$options=Object.assign({},r,n,e)}.bind(this);return this.set=i,this.set(o),this}};return a[t]}function h(e,n){return e.method="string"==typeof e.method?e.method.toUpperCase():"GET",e.enctype=a[e.enctype]||(o.includes(e.enctype)?e.enctype:o[0]),n&&(n=Object.assign({},r,n)),async function(a){var p=this.$options||n||r,h=`${p.base}${e.path}`,m={method:e.method,headers:p.headers,agent:p.fetch_agent},y=Object.keys(e.params),w=Array.from(arguments),g=e.request||p.request_middleware,v=e.response||p.response_middleware,b=u[e.enctype](),j=new URLSearchParams;for(var _ in w.length>1?a=w.reduce((function(e,t,n){return y[n]?(e[y[n]]=t,e):e}),{}):w[0]instanceof t?(a={},w[0].forEach((function(e,t){a[t]=e}))):a=1!=w.length||1!=y.length||!w[0]||w[0][y[0]]||w[0]instanceof t?a||{}:{[y[0]]:w[0]},e.params){var x=e.params[_],E=a[_]||x.default||p.values[_],S=x.name||_;if(x.required&&f(E))throw(q=new Error(x.help||`The '${_}' field is required.`)).field=q.param=_,q;if(!f(E)){if("function"==typeof x.formatter||"function"==typeof x.format){var $=x.format||x.formatter;E=$(E)}if(x.validate){var q,O="function"==typeof x.validate?x.validate(E):new RegExp(x.validate).test(E);if(!O)throw(q=new Error(x.help||`The '${_}' field is invalid.`)).field=q.param=_,q}var k="string"==typeof x.location?x.location.toLowerCase():s[m.method];if(!k||!i.includes(k))throw new Error(`Invalid location for '${_}' field.`);"headers"!=k?"body"!=k?"query"!=k?"path"==k&&(h=h.replace(new RegExp(":"+d(_)),E)):j.append(S,E):b.append(S,E):(m.headers=m.headers||{},m.headers[S]=E)}}var T=j.toString();T&&(h=`${h}?${T}`);var P=b.keys&&c(b.keys())||b.getLengthSync&&0==b.getLengthSync()||b.isEmpty&&b.isEmpty();if(P||(m.body=b.toString()),m.body&&e.enctype!==o[0]&&(m.headers=m.headers||{},m.headers["Content-Type"]=e.enctype),"function"==typeof g){var R=await Promise.resolve(g(h,m,j,b));if(!1===R)return!1;R&&R.url&&(h=R.url),R&&R.options&&(m=returns.options)}return l(h,m,p,v)}}return function e(t,n,r,a){for(var o in n){var i=n[o];if(i&&"object"==typeof i)if(i.hasOwnProperty("path")){var s=i;if(t._ne=!0,void 0!==t[o]){console.warn(`Skipping ${o} as it confilicts with another key in the object, avoid using keys like ('set') because they are reserved constructor words.`);continue}t[o]=h(s,a)}else"$options"===o&&(a=i),t[o]="$"===o.substr(0,1)?i:e({},i,o,a)}return t=t._ne?Object.assign(t,{set:p(t,r,a)}):t}({},n,!0)}!function(e,t){"function"==typeof define&&define.amd?define("wrape",[],t):"object"==typeof module&&module.exports?module.exports=t():e.Wrape=t()}("undefined"!=typeof self?self:this,(function(){const e="object"==typeof module&&module.exports?require("node-fetch"):window.fetch,t="object"==typeof module&&module.exports?require("form-data"):window.FormData;return e?t?Wrape.bind(null,e,t):(console.warn("FormData is not installed. If you are using Node please install form-data."),!1):(console.warn("Fetch API is not installed. If you are using Node please install node-fetch."),!1)}));