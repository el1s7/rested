/*
* Wrape v1.0.8
* Author: Elis <contact@elis.cc>
* License: MIT
*/
function Wrape(e,t){e=e||{};function r(e,t){var r={[t=t||"Wrape"]:function(a){if(!(this instanceof r[t]))throw new Error("You must initalize this object using 'new' command.");this.def_values=a,Object.assign(this,e);var n=function(e){if(this instanceof n)throw new Error("You can't initalize this object.");this.def_values=e}.bind(this);return this.set=n,this}};return r[t]}function a(e){return null==e}function n(e){e.method="string"==typeof e.method?e.method.toUpperCase():"GET";var r=["headers","body","query","path"],n=["multipart/form-data","application/x-www-form-urlencoded"];e.enctype=e.enctype&&n.includes(e.enctype)?e.enctype:n[0];var s={POST:"body",GET:"query"};return async function(o){var i=`${t.base}${e.path}`,u={method:e.method,headers:t.headers,agent:t.agent};request_params=Object.keys(e.params),argument_params=Array.from(arguments),o=argument_params.length>1?argument_params.reduce(function(e,t,r){return request_params[r]?(e[request_params[r]]=t,e):e},{}):1==argument_params.length&&1==request_params.length&&"object"!=typeof argument_params[0]?{[request_params[0]]:argument_params[0]}:o||{},this.def_values=this.def_values||{};var f,p=e.enctype==n[0]?new FormData:new URLSearchParams,c=new URLSearchParams;for(var d in e.params){var h=e.params[d],m=o[d]||this.def_values[d]||t.params[d]||h.default,l=h.name||d;if(h.required&&a(m))throw new Error(h.help||`The '${d}' field is required.`);if(!a(m)){if("function"==typeof h.format&&(m=h.format(m)),h.validate&&!new RegExp(h.validate).test(m))throw new Error(h.help||`The '${d}' field is invalid.`);var y="string"==typeof h.location?h.location.toLowerCase():s[u.method];if(!y||!r.includes(y))throw new Error(`Invalid location for '${d}' field.`);"headers"!=y?"body"!=y?"query"!=y?"path"==y&&(i=i.replace(new RegExp(`:${f=d,f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}`),m)):c.append(l,m):p.append(l,m):(u.headers=u.headers||{},u.headers[l]=m)}}return(c=c.toString())&&(i=`${i}?${c}`),function(e){for(var t of e)return!1;return!0}(p.keys())||(u.body=e.enctype==n[0]?p:p.toString()),function(e,t,r){return fetch(e,t).then(async function(e){if(!e.ok)return Promise.reject(e);var t=e.headers.get("Content-Type"),r={status_code:e.status,status:e.status,statusText:e.statusText,headers:e.headers};return t&&new RegExp("application/json").test(t)?r.json=await e.json():t&&new RegExp("text/").test(t)?r.text=await e.text():r.arrayBuffer=await e.arrayBuffer(),r})}(i,u)}}return t=Object.assign({base:"",headers:{},params:{},agent:!1},t),function e(t,a,s){for(var o in a){var i=a[o];if(i.hasOwnProperty("path")){var u=i;if(t._ne=!0,void 0!==t[o]){console.warn(`Skipping ${o} as it confilicts with another key in the object, avoid using keys like ('set') because they are reserved constructor words.`);continue}t[o]=n(u)}else t[o]=e({},i,o)}return t=t._ne?Object.assign(t,{set:r(t,s)}):t}({},e,!0)}!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.Wrape=t()}("undefined"!=typeof self?self:this,function(){return Wrape});